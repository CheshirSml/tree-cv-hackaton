"""
Скрипт для проверки целостности изображений в указанной директории.

Описание:
    Скрипт сканирует все файлы в заданной папке, фильтрует изображения
    с расширениями .jpg, .jpeg и .png, и проверяет их на повреждение
    с помощью метода verify() из библиотеки Pillow (PIL).
    Повреждённые файлы (битые изображения) выводятся в консоль и
    сохраняются в список для дальнейших действий (например, удаления).

Использование:
    1. Укажите путь к папке с изображениями в переменной `images_dir`.
    2. Запустите скрипт.
    3. В консоли появится список битых файлов и их общее количество.
    4. При необходимости раскомментируйте блок удаления в конце скрипта.

Зависимости:
    - Pillow (PIL): pip install Pillow

Примечания:
    - Метод `Image.verify()` проверяет структуру файла без полной загрузки
      изображения в память, что делает проверку быстрой и экономичной.
    - Скрипт игнорирует файлы с расширениями, отличными от .jpg, .jpeg, .png.
"""

from pathlib import Path
from PIL import Image

images_dir = Path("Санитарка/")  # ← ваша папка с изображениями
bad_files = []

for img_path in images_dir.glob("*.*"):
    if img_path.suffix.lower() not in {'.jpg', '.jpeg', '.png'}:
        continue
    try:
        with Image.open(img_path) as img:
            img.verify()  # проверяет целостность без загрузки в память
    except Exception as e:
        print(f"❌ Битый файл: {img_path} — {e}")
        bad_files.append(img_path)

print(f"\nНайдено битых изображений: {len(bad_files)}")
# Опционально: удалить их
# for f in bad_files:
#     f.unlink()